(function(e,t,n){"use strict";e.fn.foundationMagellan=function(n){var r=e(t),i=e(document),s=e("[data-magellan-expedition=fixed]"),o={threshold:s.length?s.outerHeight(true):0,activeClass:"active"},n=e.extend({},o,n);i.on("magellan.arrival","[data-magellan-arrival]",function(t){var r=e(this),i=r.closest("[data-magellan-expedition]"),s=i.attr("data-magellan-active-class")||n.activeClass;r.closest("[data-magellan-expedition]").find("[data-magellan-arrival]").not(this).removeClass(s);r.addClass(s)});var u=e("[data-magellan-expedition]");u.find("[data-magellan-arrival]:first").addClass(u.attr("data-magellan-active-class")||n.activeClass);s.on("magellan.update-position",function(){var t=e(this);t.data("magellan-fixed-position","");t.data("magellan-top-offset","")}).trigger("magellan.update-position");r.on("resize.magellan",function(){s.trigger("magellan.update-position")});r.on("scroll.magellan",function(){var t=r.scrollTop();s.each(function(){var r=e(this);if(r.data("magellan-top-offset")===""){r.data("magellan-top-offset",r.offset().top)}var i=t+n.threshold>r.data("magellan-top-offset");if(r.data("magellan-fixed-position")!=i){r.data("magellan-fixed-position",i);if(i){r.css({position:"fixed",top:49,width:940})}else{r.css({position:"",top:"",width:""})}}})});var a=e("[data-magellan-destination]:last");r.on("scroll.magellan",function(t){var s=r.scrollTop(),o=s+r.outerHeight(true),u=Math.ceil(a.offset().top);e("[data-magellan-destination]").each(function(){var t=e(this),r=t.attr("data-magellan-destination"),a=t.offset().top-s;if(a<=n.threshold){e("[data-magellan-arrival="+r+"]").trigger("magellan.arrival")}if(o>=i.outerHeight(true)&&u>s&&u<o){e("[data-magellan-arrival]:last").trigger("magellan.arrival")}})})}})(jQuery,this)